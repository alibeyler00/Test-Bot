<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Bot Preview Dashboard - Geli≈ümi≈ü</title>
<style>
  /* Reset ve temel ayarlar */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0; padding: 20px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: var(--bg-color);
    color: var(--text-color);
    transition: background-color 0.4s ease, color 0.4s ease;
  }
  :root {
    --bg-color: #1f2328;
    --text-color: #e4e6eb;
    --card-bg: #2c313a;
    --primary-color: #5865f2;
    --accent-color: #43b581;
    --warn-color: #f04747;
    --scrollbar-bg: #20252a;
    --scrollbar-thumb: #5865f2;
  }
  [data-theme="light"] {
    --bg-color: #f9fafb;
    --text-color: #2f3336;
    --card-bg: #ffffff;
    --primary-color: #5865f2;
    --accent-color: #43b581;
    --warn-color: #f04747;
    --scrollbar-bg: #e1e3e6;
    --scrollbar-thumb: #5865f2;
  }

  /* Scrollbar */
  ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }
  ::-webkit-scrollbar-track {
    background: var(--scrollbar-bg);
    border-radius: 10px;
  }
  ::-webkit-scrollbar-thumb {
    background: var(--scrollbar-thumb);
    border-radius: 10px;
  }

  /* Ba≈ülƒ±k */
  h1 {
    font-weight: 700;
    font-size: 2.4rem;
    margin-bottom: 25px;
    color: var(--primary-color);
    text-align: center;
  }
  h2 {
    font-weight: 600;
    margin-bottom: 15px;
    color: var(--primary-color);
  }

  /* Kutu sistemleri */
  .container {
    max-width: 1200px;
    margin: 0 auto;
  }
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(280px,1fr));
    gap: 20px;
  }

  /* Kartlar */
  .card {
    background: var(--card-bg);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 6px 15px rgb(0 0 0 / 0.2);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .card:hover {
    transform: translateY(-6px);
    box-shadow: 0 10px 25px rgb(88 101 242 / 0.4);
  }

  /* Status bar */
  #status-bar {
    background: var(--card-bg);
    padding: 15px 25px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 1.1rem;
    text-align: center;
    margin-bottom: 35px;
    color: var(--accent-color);
    box-shadow: 0 4px 10px rgb(67 181 129 / 0.4);
  }

  /* Tema se√ßici */
  #theme-select {
    padding: 10px 15px;
    font-size: 1rem;
    border-radius: 8px;
    border: none;
    background: var(--primary-color);
    color: white;
    cursor: pointer;
    box-shadow: 0 3px 6px rgb(88 101 242 / 0.5);
    transition: background 0.3s ease;
  }
  #theme-select:hover {
    background: var(--accent-color);
  }
  label[for="theme-select"] {
    font-weight: 600;
    color: var(--primary-color);
  }

  /* Komut arama input */
  #filter-input {
    width: 100%;
    padding: 12px 15px;
    font-size: 1rem;
    border-radius: 10px;
    border: none;
    margin-bottom: 20px;
    background: #3a3f4a;
    color: var(--text-color);
    box-shadow: inset 0 2px 5px rgb(0 0 0 / 0.4);
    transition: background 0.3s ease;
  }
  #filter-input::placeholder {
    color: #b0b3b8;
  }
  #filter-input:focus {
    outline: none;
    background: #50575f;
  }

  /* Komut kartlarƒ± */
  .command-card {
    background: #404652;
    padding: 15px 20px;
    border-radius: 10px;
    box-shadow: 0 0 6px rgb(67 181 129 / 0.5);
    cursor: default;
    transition: transform 0.3s ease;
  }
  .command-card:hover {
    transform: scale(1.07);
  }
  .command-name {
    font-weight: 700;
    font-size: 1.1rem;
    margin-bottom: 5px;
    color: var(--accent-color);
    text-transform: capitalize;
  }
  .command-desc {
    font-size: 0.9rem;
    opacity: 0.85;
    color: var(--text-color);
  }

  /* Event listesi */
  #events {
    background: var(--card-bg);
    padding: 15px 20px;
    border-radius: 12px;
    max-height: 250px;
    overflow-y: auto;
    font-family: 'Courier New', Courier, monospace;
    white-space: pre-wrap;
    box-shadow: inset 0 0 10px rgb(88 101 242 / 0.25);
  }

  /* Log ekranƒ± */
  #log-output {
    background: var(--card-bg);
    padding: 15px 20px;
    border-radius: 12px;
    height: 300px;
    overflow-y: auto;
    font-family: monospace;
    white-space: pre-wrap;
    box-shadow: inset 0 0 12px rgb(67 181 129 / 0.3);
    border-left: 6px solid var(--accent-color);
    color: var(--accent-color);
    font-weight: 600;
  }

  /* Responsive grid (1 s√ºtun dar ekran) */
  @media (max-width: 600px) {
    .grid {
      grid-template-columns: 1fr !important;
    }
  }
</style>
</head>
<body data-theme="dark">

  <h1>ü§ñ Logs Bot Dashboard</h1>

  <div class="container">
    <div id="status-bar">Uptime: <span id="uptime">Y√ºkleniyor...</span> | Ping: <span id="ping">Y√ºkleniyor...</span></div>

    <div style="margin-bottom: 30px; text-align: center;">
      <label for="theme-select">Tema Se√ßimi: </label>
      <select id="theme-select" aria-label="Tema Se√ßimi">
        <option value="dark" selected>Karanlƒ±k</option>
        <option value="light">A√ßƒ±k</option>
      </select>
    </div>

    <div class="grid">
      <section class="card">
        <h2>Y√ºkl√º Komutlar</h2>
        <input type="text" id="filter-input" placeholder="Komutlarda ara..." aria-label="Komutlarda ara" />
        <div id="commands">Y√ºkleniyor...</div>
      </section>

      <section class="card">
        <h2>Aktif Eventler</h2>
        <pre id="events">Y√ºkleniyor...</pre>
      </section>

      <section class="card" style="grid-column: span 2;">
        <h2>Canlƒ± Loglar</h2>
        <pre id="log-output">Loglar burada g√∂sterilecek...</pre>
      </section>
    </div>
  </div>

<script>
  const commandDescriptions = {
    ping: 'Botun pingini g√∂sterir',
    help: 'Komut yardƒ±m men√ºs√ºn√º a√ßar',
    kick: 'Kullanƒ±cƒ± atma komutu',
    ban: 'Kullanƒ±cƒ± yasaklama komutu',
    // diƒüer a√ßƒ±klamalar...
  };

  const commandsContainer = document.getElementById('commands');
  const eventsContainer = document.getElementById('events');
  const filterInput = document.getElementById('filter-input');
  const logOutput = document.getElementById('log-output');
  const uptimeEl = document.getElementById('uptime');
  const pingEl = document.getElementById('ping');
  const themeSelect = document.getElementById('theme-select');

  let allCommands = [], allEvents = [];

  async function fetchBotInfo() {
    try {
      const res = await fetch('/api/bot-info');
      const data = await res.json();
      allCommands = data.commands || [];
      allEvents = data.events || [];
      updateCommands(allCommands);
      updateEvents(allEvents);
      updateStatus();
    } catch {
      commandsContainer.textContent = 'Veri alƒ±namadƒ±.';
      eventsContainer.textContent = 'Veri alƒ±namadƒ±.';
    }
  }

  function updateCommands(cmds) {
    commandsContainer.innerHTML = '';
    if (cmds.length === 0) {
      commandsContainer.textContent = 'Y√ºkl√º komut yok';
      return;
    }
    cmds.forEach(cmd => {
      const desc = commandDescriptions[cmd.toLowerCase()] || 'A√ßƒ±klama yok';
      const card = document.createElement('div');
      card.className = 'command-card';
      card.innerHTML = `<div class="command-name">${cmd}</div><div class="command-desc">${desc}</div>`;
      commandsContainer.appendChild(card);
    });
  }

  function updateEvents(events) {
    eventsContainer.textContent = events.length === 0 ? 'Aktif event yok' : events.join('\n');
  }

  filterInput.addEventListener('input', () => {
    const filter = filterInput.value.toLowerCase();
    const filtered = allCommands.filter(c => c.toLowerCase().includes(filter));
    updateCommands(filtered);
  });

  themeSelect.addEventListener('change', () => {
    document.body.setAttribute('data-theme', themeSelect.value);
    localStorage.setItem('dashboardTheme', themeSelect.value);
  });

  const savedTheme = localStorage.getItem('dashboardTheme');
  if (savedTheme) {
    themeSelect.value = savedTheme;
    document.body.setAttribute('data-theme', savedTheme);
  }

  function updateStatus() {
    uptimeEl.textContent = (performance.now() / 1000 / 60).toFixed(1) + ' dakika';
    pingEl.textContent = Math.floor(Math.random() * 50 + 50) + ' ms';
  }

  // WebSocket baƒülantƒ±sƒ±
  const wsProtocol = window.location.protocol === 'https:' ? 'wss' : 'ws';
  const ws = new WebSocket(`${wsProtocol}://${window.location.host}/ws/logs`);

  ws.onmessage = (event) => {
    const now = new Date().toLocaleTimeString();
    logOutput.textContent = `[${now}] ${event.data}\n` + logOutput.textContent;
  };
  ws.onerror = () => {
    logOutput.textContent = '‚ö†Ô∏è Log baƒülantƒ±sƒ± kopmu≈ü veya a√ßƒ±lamƒ±yor.\n' + logOutput.textContent;
  };
  ws.onclose = () => {
    logOutput.textContent = '‚ùå Log baƒülantƒ±sƒ± kapandƒ±.\n' + logOutput.textContent;
  };

  fetchBotInfo();
  setInterval(fetchBotInfo, 30000);
</script>

</body>
</html>
